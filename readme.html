<h1 id="atelier">Atelier</h1>
<p><strong>utiliser le code fourni dans le répertoire</strong> <code>php</code> du dépôt de l'atelier <code>atelier-oblog</code> :</p>
<h2 id="objectifs">Objectifs</h2>
<ul>
<li>Avancer sur le projet oBlog 🎉</li>
<li>Utiliser le code HTML/CSS de l'intégrateur 🌈</li>
<li>Continuer à structurer plus proprement nos données avec des <code>class</code> 🤓</li>
<li>⚠️ Pour chaque étape, coder dans une <strong>branche git spécifique</strong>, puis <strong>commiter</strong> et enfin <strong>fusionner dans master</strong> une fois l'étape terminée</li>
</ul>
<h2 id="rappels-divers">Rappels divers</h2>
<ul>
<li>Le site est structuré autour d'un fichier index.php qui affiche différents templates selon la valeur de <code>$_GET['page']</code> (ou <code>filter_input(INPUT_GET, 'page')</code>).</li>
<li>Une classe définit des propriétés et des méthodes pour ses futures instances.</li>
<li>Chaque propriété, chaque méthode peut être définie en accès <code>public</code> (accessible depuis l'extérieur de la classe) ou <code>private</code> (accessible uniquement depuis l'intérieur du code de la classe), selon son utilisation/but.</li>
</ul>
<h2 id="code-fourni">Code fourni</h2>
<ul>
<li>Une intégration HTML/CSS toute prête !</li>
<li>Un fichier <code>bonus/inc/data.php</code> à utiliser à l'étape des bonus (donc on le laisse de côté pour le moment 🙏)</li>
</ul>
<h2 id="étapes">Étapes</h2>
<h3 id="étape-1---découper-scissors">Étape 1 - Découper ✂️</h3>
<p><em>On va récupérer l'intégration HTML/CSS fournie par le graphiste, et la découper en templates.</em></p>
<blockquote>
  <p>N'hésitez pas à faire plusieurs commits, avec des messages clairs 👌</p>
</blockquote>
<p>Créer une branche <code>cut-cut-cut</code> et se placer dedans.</p>
<ol>
<li>À partir de l'intégration HTML/CSS fournie dans le dossier integration-html-css/ :<ul>
<li>découper l'intégration en plusieurs morceaux, un morceau par template PHP</li>
<li>3 templates =&gt; 3 morceaux (cf. le code source de oBlog 😉)</li>
<li>pour le template central qui affiche les articles, commenter la boucle <code>foreach</code> pour le moment</li></ul></li>
<li>Bien contrôler le bon affichage de l'intégration HTML/CSS :<ul>
<li>le site doit être «&nbsp;plein de couleurs&nbsp;» et ne doit plus ressembler à une maquette filaire 👌</li>
<li>la page d'accueil doit s'afficher correctement (pas de bugs PHP)</li></ul></li>
</ol>
<p>Ajouter et commiter les modifications avec git :)  <br />
Revenir sur la branche <code>master</code> et y fusionner la branche <code>cut-cut-cut</code>.  </p>
<h3 id="étape-2---dynamiser-boom">Étape 2 - Dynamiser 💥</h3>
<p><em>On va dynamiser les templates, pour afficher les données des articles.</em></p>
<blockquote>
  <p>N'hésitez pas à faire plusieurs commits, avec des messages clairs 👌</p>
</blockquote>
<p>Créer une branche <code>dynamiser</code> et se placer dedans.</p>
<ol>
<li>Dynamiser l'affichage <em>des</em> articles dans le template home.tpl.php :<ul>
<li>adapter la boucle sur les objets <code>Article</code> pour dynamiser la liste d'article…</li>
<li>… en veillant à conserver intacte l'intégration HTML/CSS</li></ul></li>
<li>Dynamiser l'affichage d'<em>un</em> article dans le template article.tpl.php<ul>
<li>adapter l'utilisation de l'objet <code>Article</code> pour dynamiser la page d'un article…</li>
<li>… en veillant à conserver intacte l'intégration HTML/CSS</li></ul></li>
<li>On veut aussi dynamiser les catégories (affichées en haut <em>et</em> à droite) :<ul>
<li>récupérer la liste des catégories en PHP</li>
<li>itérer sur la liste dans les templates adaptés et afficher les catégories dynamiquement</li></ul></li>
<li>On veut aussi dynamiser les auteurs (affichés à droite) :<ul>
<li>récupérer la liste des auteurs en PHP</li>
<li>itérer sur la liste dans le template adapté et afficher les auteurs dynamiquement</li></ul></li>
</ol>
<p>Ajouter et commiter les modifications avec git :)  <br />
Revenir sur la branche <code>master</code> et y fusionner la branche <code>dynamiser</code>.  </p>
<p><details><summary>Exemple de code pour la liste des auteurs</summary></p>
<pre><code class="hljs html language-html"><span class="hljs-comment">&lt;!-- Auteurs: https://getbootstrap.com/docs/4.1/components/card/#list-groups --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;card&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;card-header&quot;</span>&gt;</span>Auteurs<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;list-group list-group-flush&quot;</span>&gt;</span>
    <span class="hljs-meta">&lt;?php foreach ($authors as $authorId =&gt; $authorName) : ?&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;list-group-item&quot;</span>&gt;</span>&lt;?= $authorName ?&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="hljs-meta">&lt;?php endforeach; ?&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p></details></p>
<h3 id="étape-3---liens-internes-anchor">Étape 3 - Liens internes ⚓️</h3>
<p><em>On continue à dynamiser le site, cette fois en gérant les liens entre les pages.</em></p>
<blockquote>
  <p>N'hésitez pas à faire plusieurs commits, avec des messages clairs 👌</p>
</blockquote>
<p>Créer une branche <code>liens</code> et se placer dedans.</p>
<ol>
<li>Dans l'entête de la page :<ul>
<li>définir le lien vers chaque page catégorie</li>
<li>l'URL d'un lien ressemblera à <code>index.php?page=category&amp;id=4</code> (ici <code>4</code> pour la catégorie dont l'id est 4)</li>
<li>⚠️ l'id doit être géré dynamiquement au sein de l'itération</li></ul></li>
<li>Dans la sidebar à droite :<ul>
<li>définir le lien vers chaque page catégorie (même principe que pour l'entête)</li>
<li>définir le lien vers chaque page auteur (même principe que pour les catégories)</li>
<li>⚠️ l'id doit être géré dynamiquement au sein de l'itération</li></ul></li>
</ol>
<p>Vérifier que tous les liens fonctionnent bien.  </p>
<blockquote>
  <p>✋ A cette étape on affiche uniquement les noms des auteurs et des catégories.  <br />
  Les articles liés seront affichés aux étapes 5 et 6.</p>
</blockquote>
<p>Ajouter et commiter les modifications avec git :)  <br />
Revenir sur la branche <code>master</code> et y fusionner la branche <code>liens</code>.  </p>
<h3 id="étape-4---classes-category--author-sunglasses">Étape 4 - Classes Category &amp; Author 😎</h3>
<p><em>On améliore la gestion des données.</em></p>
<blockquote>
  <p>N'hésitez pas à faire plusieurs commits, avec des messages clairs 👌</p>
</blockquote>
<p>Créer une branche <code>classes-category-author</code> et se placer dedans.</p>
<ol>
<li>Dans le fichier <code>inc/data.php</code>, modifier le code pour utiliser les 2 variables fournies dans le spoiler ci-dessous<ul>
<li>observer que les données transmises aux templates sont différentes</li>
<li><strong>en conséquence, il faudra plus tard (partie 3 ci-dessous) adapter le code des templates pour conserver un affichage correct, mais d'abord, nous devons créer les classes en codant la partie 2</strong></li></ul></li>
<li>Créer deux nouvelles classes dans <code>inc/classes/</code> :<ul>
<li>une classe <code>Category</code> pour structurer les données de chaque catégorie</li>
<li>une classe <code>Author</code> pour structurer les données de chaque auteur</li>
<li>ces 2 classes ressembleront beaucoup à la classe <code>Article</code> déjà créée</li></ul></li>
<li>Corriger l'affichage des templates en mettant à profit ces deux nouvelles classes.<ul>
<li><strong>rappel : <code>$object-&gt;property</code></strong></li></ul></li>
</ol>
<p>Vérifier que toutes les pages sont toujours fonctionnelles.  <br />
Ajouter et commiter les modifications avec git :)  <br />
Revenir sur la branche <code>master</code> et y fusionner la branche <code>classes-category-author</code>.  </p>
<p><details><summary>Indice(s)</summary></p>
<ul>
<li>il faudra coder un ou des paramètre(s) optionnel(s) au constructeur afin de déterminer la valeur de la ou les propriété(s)</li>
</ul>
<p></details></p>
<p><details><summary>2 variables pour inc/data.php</summary></p>
<pre><code class="hljs php language-php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-comment">// [...]</span>

<span class="hljs-comment">// Les catégories</span>
<span class="hljs-variable">$dataCategoriesList</span> = [
    <span class="hljs-comment">// ID =&gt; objet Category</span>
    <span class="hljs-number">1</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Category</span>(<span class="hljs-string">&#x27;TeamBack&#x27;</span>),
    <span class="hljs-number">2</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Category</span>(<span class="hljs-string">&#x27;TeamFront&#x27;</span>),
    <span class="hljs-number">3</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Category</span>(<span class="hljs-string">&#x27;Collaboration&#x27;</span>),
    <span class="hljs-number">4</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Category</span>(<span class="hljs-string">&#x27;Ma Vie De Dev&#x27;</span>)
];

<span class="hljs-comment">// Les auteurs</span>
<span class="hljs-variable">$dataAuthorsList</span> = [
    <span class="hljs-comment">// ID =&gt; objet Author</span>
    <span class="hljs-number">1</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Author</span>(<span class="hljs-string">&#x27;Maxime&#x27;</span>),
    <span class="hljs-number">2</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Author</span>(<span class="hljs-string">&#x27;Anthony&#x27;</span>),
    <span class="hljs-number">3</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Author</span>(<span class="hljs-string">&#x27;Alexandre&#x27;</span>),
    <span class="hljs-number">4</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Author</span>(<span class="hljs-string">&#x27;Dario&#x27;</span>),
    <span class="hljs-number">5</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Author</span>(<span class="hljs-string">&#x27;Julie&#x27;</span>),
    <span class="hljs-number">6</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Author</span>(<span class="hljs-string">&#x27;Lucie&#x27;</span>),
    <span class="hljs-number">7</span> =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Author</span>(<span class="hljs-string">&#x27;Xavier&#x27;</span>)
];
</code></pre>
<p></details></p>
<h3 id="étape-5---page-catégorie-doughnut">Étape 5 - Page catégorie 🍩</h3>
<p><em>On va améliorer la page d'une catégorie.</em></p>
<blockquote>
  <p>N'hésitez pas à faire plusieurs commits, avec des messages clairs 👌</p>
</blockquote>
<p>Créer une branche <code>page-category</code> et se placer dedans.</p>
<ol>
<li>Dans le template category.tpl.php on veut afficher le nom de la catégorie dans un <code>&lt;h1&gt;</code> :<ul>
<li>récupérer un objet <code>Category</code> à partir de son id</li></ul></li>
<li>On veut également afficher la liste de tous les articles associés à cette catégorie :<ul>
<li>récupérer un tableau d'objets <code>Article</code> à partir de la catégorie</li>
<li>modifier les templates pour afficher les données sur le site</li></ul></li>
</ol>
<p>Vérifier que la page s'affiche correctement.  <br />
Ajouter et commiter les modifications avec git :)  <br />
Revenir sur la branche <code>master</code> et y fusionner la branche <code>page-category</code>.  </p>
<p><details><summary>Indices pour la récupération des articles d'une catégorie</summary></p>
<ul>
<li>⚠️ attention à ne pas récupérer <em>tous</em> les articles, mais bien uniquement ceux dont le nom de la catégorie correspond au nom de la catégorie demandée</li>
<li>idée : on peut créer un tableau vide, qu'on remplira avec les articles de la catégorie, au fur et à mesure</li>
<li>pour chaque article du site, <em>si</em> le nom de sa catégorie correspond à la catégorie demandée, <em>alors</em> ajouter l'article dans le tableau</li>
<li>à la fin de l'itération, le tableau, à retourner, comprendra seulement les articles de la catégorie</li>
</ul>
<p></details></p>
<h3 id="étape-6---page-auteur-icecream">Étape 6 - Page auteur 🍦</h3>
<p>Créer une branche <code>page-author</code> et se placer dedans.</p>
<blockquote>
  <p>C'est comme l'étape précédente, mais avec les auteurs au lieu des catégories 😉</p>
</blockquote>
<p>Vérifier que la page s'affiche correctement.  <br />
Ajouter et commiter les modifications avec git :)  <br />
Revenir sur la branche <code>master</code> et y fusionner la branche <code>page-author</code>.</p>
<p><strong>Fin de l'atelier 🎉</strong></p>
<h2 id="bonus">Bonus</h2>
<p>En cliquant sur <a href="bonus.md">ce lien</a>, je confirme avoir terminé l'atelier avant l'heure et je confirme souhaiter être confronté à une demande qui n'aura pas été vue en cours.</p>